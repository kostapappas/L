#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Υπολογιστής Δημοτικών Τελών - Δήμος Άρτας
Απλό παράδειγμα Flask εφαρμογής για εκπαιδευτικούς σκοπούς

Αυτή η εφαρμογή υπολογίζει το κόστος έκδοσης πιστοποιητικών
"""

from flask import Flask, render_template, request, redirect, url_for

# Δημιουργία της Flask εφαρμογής
app = Flask(__name__)

# Σταθερές για τον υπολογισμό (εύκολο να αλλάξουν οι σπουδαστές)
ΒΑΣΙΚΟ_ΚΟΣΤΟΣ = 3.0  # Βασικό κόστος πιστοποιητικού σε ευρώ
ΚΟΣΤΟΣ_ΕΠΕΙΓΟΝ = 2.0  # Επιπλέον κόστος για επείγον σε ευρώ

# Λίστα με τους τύπους πιστοποιητικών (εύκολο να προσθέσουν νέους)
ΤΥΠΟΙ_ΠΙΣΤΟΠΟΙΗΤΙΚΩΝ = [
    'Γέννησης',
    'Θανάτου', 
    'Οικογενειακής Κατάστασης',
    'Σπουδών',
    'Στρατολογικής Κατάστασης'
]

@app.route('/')
def αρχική_σελίδα():
    """Εμφανίζει τη φόρμα υπολογισμού"""
    return render_template('calculator.html', τυποι=ΤΥΠΟΙ_ΠΙΣΤΟΠΟΙΗΤΙΚΩΝ)

@app.route('/υπολογισμος', methods=['POST'])
def υπολογισμος_κοστους():
    """Υπολογίζει το κόστος βάσει των στοιχείων της φόρμας"""
    
    # Παίρνουμε τα δεδομένα από τη φόρμα
    ονομα = request.form.get('ονομα', '').strip()
    τυπος_πιστοποιητικου = request.form.get('τυπος_πιστοποιητικου', '')
    επειγον = request.form.get('επειγον') == 'ναι'  # True αν επιλέχθηκε "ναι"
    
    # Έλεγχος αν υπάρχουν τα απαραίτητα στοιχεία
    if not ονομα or not τυπος_πιστοποιητικου:
        # Αν λείπουν στοιχεία, επιστρέφουμε στη φόρμα με μήνυμα σφάλματος
        return render_template('calculator.html', 
                             τυποι=ΤΥΠΟΙ_ΠΙΣΤΟΠΟΙΗΤΙΚΩΝ,
                             σφαλμα="Παρακαλώ συμπληρώστε όλα τα πεδία!")
    
    # Υπολογισμός του συνολικού κόστους
    συνολικο_κοστος = ΒΑΣΙΚΟ_ΚΟΣΤΟΣ
    
    if επειγον:
        συνολικο_κοστος += ΚΟΣΤΟΣ_ΕΠΕΙΓΟΝ
    
    # Δημιουργία της περιγραφής του υπολογισμού
    περιγραφη_υπολογισμου = f"Βασικό κόστος: €{ΒΑΣΙΚΟ_ΚΟΣΤΟΣ}"
    
    if επειγον:
        περιγραφη_υπολογισμου += f" + Επείγον: €{ΚΟΣΤΟΣ_ΕΠΕΙΓΟΝ}"
    
    # Στέλνουμε τα αποτελέσματα στο template
    return render_template('αποτελεσμα.html',
                         ονομα=ονομα,
                         τυπος=τυπος_πιστοποιητικου,
                         επειγον=επειγον,
                         κοστος=συνολικο_κοστος,
                         περιγραφη=περιγραφη_υπολογισμου)

@app.route('/οδηγιες')
def σελιδα_οδηγιων():
    """Εμφανίζει τις οδηγίες για τις ασκήσεις"""
    return render_template('οδηγιες.html')

if __name__ == '__main__':
    print("🧮 Ξεκινάει ο Υπολογιστής Δημοτικών Τελών...")
    print("🌐 Επισκεφτείτε: http://localhost:5002")
    print("📚 Οδηγίες ασκήσεων: http://localhost:5002/οδηγιες")
    app.run(debug=True, host='0.0.0.0', port=5002) 